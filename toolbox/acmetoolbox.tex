\documentclass{beamer}

\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}

\usepackage{pgfkeys, pgffor}

\makeatletter
\let\@EA\expandafter
\let\@NX\noexpand

%<< \do(single|double|triple)empty ·· >>

\makeatletter

\def\@@expanded{}
\def\expanded#1{\edef\@@expanded{\@NX#1}\@@expanded}

\let\@NX\noexpand
\let\@EA\expandafter
\def\@EAEAEA{\expandafter\expandafter\expandafter}

\let\doifnextcharelse\@ifnextchar
\def\doifnextoptionalelse{\doifnextcharelse[}
\def\doifnextbgroupelse{\doifnextcharelse\bgroup}

\def\dosingleempty#1% we can make dedicated doifnextoptional's
  {\doifnextoptionalelse
     {\firstargumenttrue#1}%
     {\dosinglefakeempty#1}}

\def\dodoubleempty#1%
  {\doifnextoptionalelse
     {\dodoubletestempty#1}%
     {\dodoublefakeempty#1}}

\def\dosinglefakeempty#1%
  {\firstargumentfalse#1[]}

\def\dodoublefakeempty#1%
  {\firstargumentfalse\secondargumentfalse#1[][]}

\def\dotriplefakeempty#1%
  {\firstargumentfalse\secondargumentfalse\thirdargumentfalse#1[][][]}

\long\def\dodoubletestempty#1[#2]%
  {\firstargumenttrue
   \doifnextoptionalelse
     {\secondargumenttrue #1[{#2}]}%
     {\secondargumentfalse#1[{#2}][]}}

\newif\iffirstargument
\newif\ifsecondargument

%>>
%<< \processcommalist ··············· >>

\def\processcommalist[#1]#2{%
  \pgfqkeys{/processcommalist}{.code=#2{##1}, .list={#1}}}

%>>
%<< \getparameters, \geteparameters · >>

\pgfkeysdef{/handlers/.store in cs}{%
  \pgfkeysdef{\pgfkeyscurrentpath}{\@EA\def\csname#1\endcsname{##1}}}
\pgfkeysdef{/handlers/.estore in cs}{%
  \pgfkeysdef{\pgfkeyscurrentpath}{\@EA\edef\csname#1\endcsname{##1}}}

\pgfkeys{/handlers/.parameter/.code=\pgfkeysalso{%
  /def/\acme@root\acme@familly/.cd, #1/.store in cs=\acme@root\acme@familly#1,
  /edef/\acme@root\acme@familly/.cd, #1/.estore in cs=\acme@root\acme@familly#1}}

\pgfqkeys{/parameters}{%
  root/.estore in=\acme@root,
  familly/.estore in=\acme@familly,
  root=, familly=@@,
  .unknown/.style={familly=\pgfkeyscurrentname}}

\def\declareparameters{\dodoubleempty\dodeclareparameters}
\def\dodeclareparameters[#1][#2]{%
  \ifsecondargument\dodeclareparametersindeed[#1][#2]
  \else\dodeclareparametersindeed[][#1]\fi}
\def\dodeclareparametersindeed[#1][#2]{%
  \pgfqkeys{/parameters}{root=, familly=@@, #1}
  \pgfqkeys{/handlers}{.parameter/.list={#2}}}

\def\getparameters{\dodoubleempty\dogetparameters}
\def\dogetparameters[#1][#2]{%
  \ifsecondargument\dogetparametersindeed[#1][#2]
  \else\dogetparametersindeed[][#1]\fi}
\def\dogetparametersindeed[#1][#2]{%
  \pgfqkeys{/parameters}{root=, familly=@@, #1}
  \pgfqkeys{/def/\acme@root\acme@familly}{#2}}

\def\geteparameters{\dodoubleempty\dogeteparameters}
\def\dogeteparameters[#1][#2]{%
  \ifsecondargument\dogeteparametersindeed[#1][#2]
  \else\dogeteparametersindeed[][#1]\fi}
\def\dogeteparametersindeed[#1][#2]{%
  \pgfqkeys{/parameters}{root=, familly=@@, #1}
  \pgfqkeys{/edef/\acme@root\acme@familly}{#2}}

%>>

\begin{document}

\makeatletter

\begin{frame}

\declareparameters[root=acme][toto]
\declareparameters[root=acme, familly=framed][height, width]

\def\toto{toto}

\getparameters[root=acme][toto=titi]
\getparameters[root=acme, framed][height=\toto, width=24pt]

\def\toto{tata}

\geteparameters[root=acme, familly=framed][height=\toto, width=24pt]

\def\toto{titi}

\acmeframedheight--\acmeframedwidth

\acme@@toto
\show\foreach


\end{frame}

\end{document}
